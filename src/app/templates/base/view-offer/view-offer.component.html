<div class="category_mainwrap freelancer_profile contract_details_mainwrap">
    <!--start freelancer_profile-->
    <div class="breadcrumb_wrap">
        <!--start breadcrumb_wrap-->
        <div class="container">
            <!--start container-->
            <div class="row">
                <!--start row-->
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <!--start col-->
                    <h4>Contract Details</h4>
                </div>
                <!--end col-->
            </div>
            <!--end row-->
        </div>
        <!--end container-->
    </div>
    <!--end breadcrumb_wrap-->
    <div class="freelancer-wrap" *ngIf="display">
        <div class="container">
            <div class="row">
                <div class="col-lg-9 col-md-12 col-sm-12 col-xs-12 contract_details_page">
                    <div class="bg-box profile_bg-box">
                        <!--start bg-box-->
                        <section class="profile-details">
                            <div class="row">
                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 header_block">
                                    <h5><span>
                      <span *ngIf="offerData.offer_status === 'Modified by client';else offerstatusnotmodified">Modified
                        by Client</span>
                                        <ng-template #offerstatusnotmodified>

                                            <span *ngIf="offerData.offer_status == 'Withdraw by client';else offerstatusnotwitdr">
                            Withdraw by client
                        </span>

                                            <ng-template #offerstatusnotwitdr>
                                                <h4 class="{{offerData.offer_status}}">{{offerData.offer_status}}</h4>
                                            </ng-template>

                                        </ng-template>
                                        </span> - Expires on {{expires|date:'mediumDate'}}</h5>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 contract_details_left">
                                    <label>Contract Title</label>
                                </div>
                                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 contract_details_right">
                                    <span>{{offerData.title}}</span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 contract_details_left">
                                    <label>Job Category</label>
                                </div>
                                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 contract_details_right">
                                    <span>{{offerData.job_category.name}} / {{offerData.job_subcategory.name}}</span>
                                </div>
                            </div>

                            <div class="row" *ngIf="offerData.type=='Hourly'">
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 contract_details_left">
                                    <label>Hourly Rate</label>
                                </div>
                                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 contract_details_right">
                                    <label>Rs.{{offerData.amount}}</label>
                                </div>
                            </div>

                            <div class="row" *ngIf="offerData.type=='Hourly'">
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 contract_details_left">
                                    <label>Weekly Limit</label>
                                </div>
                                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 contract_details_right">
                                    <label>{{contracts_type[offerData.limit-1].name}}</label>
                                </div>
                            </div>

                            <div class="row" *ngIf="offerData.type=='Fixed'">
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 contract_details_left">
                                    <label>Budget</label>
                                </div>
                                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 contract_details_right">
                                    <label>Rs.{{offerData.amount}}</label>
                                </div>
                            </div>

                            <div class="row" *ngIf="offerData.type=='Fixed' && offerData.milestones.length > 0">
                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 contract_details_left">
                                    <label>Milestone(s)</label>
                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 contract_details_left">
                                    <div class="right_side_table">
                                        <div class="table-responsive">
                                            <table mat-table [dataSource]="offerData.milestones" class="mat-elevation-z8" matSort>
                                                <!-- Name Column -->
                                                <ng-container matColumnDef="name">
                                                    <th mat-header-cell *matHeaderCellDef>Name</th>
                                                    <td mat-cell *matCellDef="let element"> {{element.name}} </td>
                                                </ng-container>
                                                <!-- Amount Column -->
                                                <ng-container matColumnDef="amount">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Amount </th>
                                                    <td mat-cell *matCellDef="let element">${{element.deposit_amount}} </td>
                                                </ng-container>
                                                <!-- Due Date Column -->
                                                <ng-container matColumnDef="due_date">
                                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Due Date</th>
                                                    <td mat-cell *matCellDef="let element"> {{element.due_date}} </td>
                                                </ng-container>
                                                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 contract_details_left">
                                    <label>Offer Date</label>
                                </div>
                                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 contract_details_right">
                                    <span>{{offerData.created|date:'mediumDate'}}</span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 contract_details_left">
                                    <label>Start Date</label>
                                </div>
                                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 contract_details_right">
                                    <span>{{offerData.start_date|date:'mediumDate'}}</span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 contract_details_left">
                                    <label>Client Message</label>
                                </div>
                                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 contract_details_right">
                                    <span>{{offerData.description}}</span>
                                </div>
                            </div>
                            <div class="row" *ngIf="offerData.request_discription">
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 contract_details_left">
                                    <label>Freelancer Message</label>
                                </div>
                                <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8 contract_details_right">
                                    <span>{{offerData.request_discription}}</span>
                                </div>
                            </div>
                            <div class="row" *ngIf="disputeCount > 0">
                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 contract_details_left">
                                    <label>Dispute</label>
                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 contract_details_left">
                                    <div class="right_side_table">
                                        <div class="table-responsive">
                                            <table #table mat-table [dataSource]="messageData" class="mat-elevation-z8">
                                                <!-- Name Column -->
                                                <ng-container matColumnDef="user_name">
                                                    <th mat-header-cell *matHeaderCellDef>Name</th>
                                                    <td mat-cell *matCellDef="let element"> {{element.user_name}} </td>
                                                </ng-container>
                                                <!-- Amount Column -->
                                                <ng-container matColumnDef="chat_message">
                                                    <th mat-header-cell *matHeaderCellDef>Message </th>
                                                    <td mat-cell *matCellDef="let element">{{element.chat_message}} </td>
                                                </ng-container>
                                                <!-- Due Date Column -->
                                                <ng-container matColumnDef="time">
                                                    <th mat-header-cell *matHeaderCellDef>Created Date</th>
                                                    <td mat-cell *matCellDef="let element"> {{element.time}} </td>
                                                </ng-container>
                                                <tr mat-header-row *matHeaderRowDef="displayedMsgColumns"></tr>
                                                <tr mat-row *matRowDef="let row; columns: displayedMsgColumns;"></tr>
                                            </table>
                                            <mat-paginator [ngStyle]="{display: Paginatorhidder ? 'block' : 'none'}" #DisputesPaginator [hidePageSize]="true" [length]="disputeCount" [pageSize]="10" (page)="onPageChange($event)"></mat-paginator>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 contract_details_left">

                                </div>
                                <div *ngIf="is_owner==false && offerData.offer_status == 'Pending'" class="col-lg-8 col-md-8 col-sm-8 col-xs-8 contract_details_right">
                                    <button mat-button (click)="updateOffer(3);">Accept Offer</button>
                                    <button mat-button class="cancel_button" (click)="updateOffer(4);">Decline Offer</button>
                                </div>
                            </div>
                        </section>
                        <!--end profile-details-->
                    </div>
                    <!--end bg-box-->
                </div>
                <!--end col-->
                <div class="col-lg-3 col-md-12 col-sm-12 col-xs-12">
                    <!--start col div-->
                    <div class="bg-box bg-boxright bg-boxright_blk">
                        <!--start bg-box-->
                        <div *ngIf="offerData.status === 'Completed' || offerData.status === 'Closed';else other_content" class="row button_right">
                            <!-- <div class="row button_right"> -->
                            <div *ngIf="offerData.status === 'Completed'" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 button_block">
                                <div class="button_block_btn">
                                    <button mat-button class="withdraw_button">contract completed</button>
                                </div>
                            </div>
                            <div *ngIf="offerData.status === 'Closed'" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 button_block">
                                <div class="button_block_btn">
                                    <button mat-button class="withdraw_button">contract closed</button>
                                </div>
                            </div>
                            <!-- <div *ngIf="(offerData.status === 'Completed' || offerData.status === 'Closed') && this.userType == 2 && this.displayDispute" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 button_block">
                                <div class="button_block_btn">
                                    <button mat-button class="withdraw_button" (click)="dispute(this.userType,'create');">Rise Dispute</button>
                                </div>
                            </div> -->
                            <!-- <div *ngIf="(offerData.status === 'Completed' || offerData.status === 'Closed') && this.displayReply" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 button_block">
                                <div class="button_block_btn">
                                    <button mat-button class="withdraw_button" (click)="dispute(this.userType,'reply');">Reply Dispute</button>
                                </div>
                            </div>

                            <div *ngIf="(offerData.status === 'Completed' || offerData.status === 'Closed') && this.displayReply" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 button_block">
                                <div class="button_block_btn">
                                    <button mat-button class="withdraw_button" (click)="dispute(this.userType,'close');">Accept and Close Dispute</button>
                                </div>
                            </div> -->
                            <!-- </div> -->
                        </div>
                        <ng-template #other_content>
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 button_block">
                                <div class="button_block_btn">
                                    <button mat-button class="withdraw_button" *ngIf="is_owner && offerData.offer_status == 'Pending'" (click)="updateOffer(1);">Withdraw Offer</button>
                                </div>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 button_block">
                                <button mat-button class="withdraw_button" *ngIf="offerData.milestones.length > 0 && offerData.type=='Fixed' && offerData.offer_status == 'Accept'" routerLink="/milestones-payments/{{offer_id}}/{{offerData.message_id}}">Milestone & Payments</button>
                                <button mat-button class="withdraw_button" *ngIf="offerData.type=='Hourly' && offerData.offer_status == 'Accept'" routerLink="/time-payments/{{offer_id}}/{{offerData.message_id}}">Time & Payments</button>
                            </div>

                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 button_block">
                                <button mat-button routerLink="/chat-room/{{offerData.message_id}}">Messages</button>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 button_block">
                                <button mat-button *ngIf="is_owner && offerData.offer_status == 'Pending'" (click)="updateOffer(2);">Modify
                  Offer</button>
                            </div>
                            <div *ngIf="offerData.type=='Fixed' && !is_owner && !offerData.payment_request && offerData.milestones.length === 0 && offerData.offer_status == 'Accept'" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 button_block">
                                <button mat-button (click)="onPaymentRequest()">Request To Close Contract</button>
                            </div>
                            <div *ngIf="offerData.type=='Fixed' && is_owner && offerData.payment_request && offerData.milestones.length === 0 && offerData.offer_status == 'Accept'" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 button_block">
                                <button mat-button (click)="onFixedWTPayment()">Close Contract</button>
                            </div>
                        </ng-template>
                    </div>
                    <!--end bg-box-->
                    <div class="bg-box bg-boxright bg-boxright_blk">
                        <!--start bg-box-->
                        <h1>Parties</h1>
                        <mat-list role="list">
                            <mat-list-item role="listitem">
                                <div class="div_row">
                                    <h2>Offer made by:</h2>
                                    <div class="left">
                                        <img src="{{user_avatar_url}}?id={{offerData.client.id}}" />
                                    </div>
                                    <div class="right">
                                        <h3>{{offerData.client.first_name}} {{offerData.client.last_name}}</h3>
                                        <h4>
                                            <span *ngIf="offerData.client.category == '';else isclientcategory">
                        Nil
                      </span>
                                            <ng-template #isclientcategory>
                                                {{offerData.client.category}}
                                            </ng-template>
                                        </h4>
                                    </div>
                                </div>
                            </mat-list-item>
                            <mat-list-item role="listitem">
                                <div class="div_row">
                                    <h2>Offer made to:</h2>
                                    <div class="left">
                                        <img src="{{user_avatar_url}}?id={{offerData.freelancer.id}}" />
                                    </div>
                                    <div class="right">
                                        <h3>{{offerData.freelancer.first_name}} {{offerData.freelancer.last_name}}</h3>
                                        <h4>
                                            <span *ngIf="offerData.freelancer.category == '';else isfreelancercategory">
                        Nil
                      </span>
                                            <ng-template #isfreelancercategory>
                                                {{offerData.freelancer.category}}
                                            </ng-template>
                                        </h4>
                                    </div>
                                </div>
                            </mat-list-item>
                        </mat-list>
                    </div>
                    <!--end bg-box-->
                    <div class="bg-box bg-boxright bg-boxright_blk related_link_block">
                        <!--start bg-box-->
                        <h1>Related Links</h1>
                        <mat-list role="list">
                            <mat-list-item role="listitem">
                                <div class="div_row">
                                    <a routerLink="/chat-room/{{offerData.message_id}}">View messages associated with this offer </a>
                                </div>
                            </mat-list-item>
                        </mat-list>
                    </div>
                    <!--end bg-box-->
                </div>
                <!--end col-->
            </div>
            <!--end row-->
        </div>
        <!--end container-->
    </div>
    <!--end freelancer-wrap-->
</div>
<!--end freelancer_profile-->